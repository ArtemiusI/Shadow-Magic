IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  HaveSpellRES("C0SA201")
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA201",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  HaveSpellRES("C0SA502")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA502",Myself)
END

IF
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  Allegiance(Myself,EVILCUTOFF)
  !AreaType(OUTDOOR)
  !Range(NearestEnemyOf(Myself),30)
  Range(NearestDoor,15)
  OpenState(NearestDoor,FALSE)
THEN
  RESPONSE #100
    MoveToObject(NearestDoor)
    OpenDoor(NearestDoor)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA706")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA706",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA407")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA407",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA207")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA207",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HPPercentLT(Myself,80)
  HaveSpellRES("C0SA304")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA304",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA503")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  OR(4)
    CheckSpellState(Nearestenemyof(Myself),BUFF_PRO_WEAPONS)
    CheckStatGT(Nearestenemyof(Myself),0,STONESKINS)
    CheckSpellState(Nearestenemyof(Myself),BUFF_PRO_EFFECTS)
    CheckSpellState(Nearestenemyof(Myself),BUFF_PRO_DAMAGE)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA503",Nearestenemyof(Myself))
  RESPONSE #100
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA606")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  CheckSpellState(Nearestenemyof(Myself),BUFF_PRO_SPELLS)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA606",Nearestenemyof(Myself))
  RESPONSE #100
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA704")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA704",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  OR(2)
  !AreaType(OUTDOOR)
  TimeOfDay(NIGHT)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA512")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA512",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA404")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA404",Myself)
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player1,90)
  See(Player1)
  !StateCheck(Player1,STATE_REALLY_DEAD)
  !StateCheck(Player1,STATE_NOT_TARGETABLE)
  !StateCheck(Player1,STATE_HARMLESS)
  !CheckStatGT(Player1,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player1,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player1,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player1,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player1,0,CLERIC_FREE_ACTION)
  !CheckStat(Player1,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player1,1,SCRIPTINGSTATE4)
  !HasItemEquipedReal("NPSW01",Player1)
  !HasItemEquipedReal("SW1H27",Player1)
  !HasItemEquiped("RING09",Player1)
  !HasItemEquipedReal("SW2H06",Player1)
  CheckStatLT(Player1,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player1)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player2,90)
  See(Player2)
  !StateCheck(Player2,STATE_REALLY_DEAD)
  !StateCheck(Player2,STATE_NOT_TARGETABLE)
  !StateCheck(Player2,STATE_HARMLESS)
  !CheckStatGT(Player2,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player2,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player2,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player2,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player2,0,CLERIC_FREE_ACTION)
  !CheckStat(Player2,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player2,1,SCRIPTINGSTATE4)
  !CheckStat(Player2,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player2)
  !HasItemEquipedReal("SW1H27",Player2)
  !HasItemEquiped("RING09",Player2)
  !HasItemEquipedReal("SW2H06",Player2)
  CheckStatLT(Player2,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player2)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player3,90)
  See(Player3)
  !StateCheck(Player3,STATE_REALLY_DEAD)
  !StateCheck(Player3,STATE_NOT_TARGETABLE)
  !StateCheck(Player3,STATE_HARMLESS)
  !CheckStatGT(Player3,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player3,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player3,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player3,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player3,0,CLERIC_FREE_ACTION)
  !CheckStat(Player3,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player3,1,SCRIPTINGSTATE4)
  !CheckStat(Player3,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player3)
  !HasItemEquipedReal("SW1H27",Player3)
  !HasItemEquiped("RING09",Player3)
  !HasItemEquipedReal("SW2H06",Player3)
  CheckStatLT(Player3,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player3)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player4,90)
  See(Player4)
  !StateCheck(Player4,STATE_REALLY_DEAD)
  !StateCheck(Player4,STATE_NOT_TARGETABLE)
  !StateCheck(Player4,STATE_HARMLESS)
  !CheckStatGT(Player4,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player4,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player4,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player4,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player4,0,CLERIC_FREE_ACTION)
  !CheckStat(Player4,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player4,1,SCRIPTINGSTATE4)
  !CheckStat(Player4,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player4)
  !HasItemEquipedReal("SW1H27",Player4)
  !HasItemEquiped("RING09",Player4)
  !HasItemEquipedReal("SW2H06",Player4)
  CheckStatLT(Player4,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player4)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player5,90)
  See(Player5)
  !StateCheck(Player5,STATE_REALLY_DEAD)
  !StateCheck(Player5,STATE_NOT_TARGETABLE)
  !StateCheck(Player5,STATE_HARMLESS)
  !CheckStatGT(Player5,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player5,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player5,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player5,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player5,0,CLERIC_FREE_ACTION)
  !CheckStat(Player5,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player5,1,SCRIPTINGSTATE4)
  !CheckStat(Player5,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player5)
  !HasItemEquipedReal("SW1H27",Player5)
  !HasItemEquiped("RING09",Player5)
  !HasItemEquipedReal("SW2H06",Player5)
  CheckStatLT(Player5,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player5)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player6,90)
  See(Player6)
  !StateCheck(Player6,STATE_REALLY_DEAD)
  !StateCheck(Player6,STATE_NOT_TARGETABLE)
  !StateCheck(Player6,STATE_HARMLESS)
  !CheckStatGT(Player6,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player6,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player6,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player6,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player6,0,CLERIC_FREE_ACTION)
  !CheckStat(Player6,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player6,1,SCRIPTINGSTATE4)
  !CheckStat(Player6,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player6)
  !HasItemEquipedReal("SW1H27",Player6)
  !HasItemEquiped("RING09",Player6)
  !HasItemEquipedReal("SW2H06",Player6)
  CheckStatLT(Player6,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player6)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See([GOODCUTOFF])
  HPLT(Nearestenemyof(Myself),90)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),9,LEVEL)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.PALADIN_ALL])
  Kit(Nearestenemyof(Myself),INQUISITOR)
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.LONG_BOW])
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.LONG_BOW]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([PC.0.0.LONG_BOW]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.DRUID_ALL])
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.DRUID_ALL]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([PC.0.0.DRUID_ALL]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.CLERIC_ALL])
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.CLERIC_ALL]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([PC.0.0.CLERIC_ALL]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.BARD_ALL])
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.BARD_ALL]))
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See([GOODCUTOFF])
  HPLT(Nearestenemyof(Myself),20)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(Nearestenemyof(Myself),BARBARIAN_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),BERSERKER_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),MINSC_BERSERK)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SecondNearest([GOODCUTOFF]))
  OR(2)
  HPLT(Nearestenemyof(Myself),20)
  LevelGT(Myself,9)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(Nearestenemyof(Myself),BARBARIAN_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),BERSERKER_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),MINSC_BERSERK)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(ThirdNearest([GOODCUTOFF]))
  OR(2)
  HPLT(Nearestenemyof(Myself),20)
  LevelGT(Myself,9)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(Nearestenemyof(Myself),BARBARIAN_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),BERSERKER_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),MINSC_BERSERK)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FourthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(Nearestenemyof(Myself),20)
  LevelGT(Myself,9)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(Nearestenemyof(Myself),BARBARIAN_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),BERSERKER_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),MINSC_BERSERK)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FifthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(Nearestenemyof(Myself),20)
  LevelGT(Myself,9)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(Nearestenemyof(Myself),BARBARIAN_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),BERSERKER_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),MINSC_BERSERK)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SixthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(Nearestenemyof(Myself),20)
  LevelGT(Myself,9)
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(Nearestenemyof(Myself),BARBARIAN_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),BERSERKER_RAGE)
  !CheckSpellState(Nearestenemyof(Myself),MINSC_BERSERK)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA608")
  See(Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  StateCheck(Nearestenemyof(Myself),STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA608",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA611")
  See(Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  StateCheck(Nearestenemyof(Myself),STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA611",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA708")
  See(Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA708",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA710")
  See(Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA710",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA610")
  See(Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA610",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  OR(3)
    See([GOODCUTOFF.0.0.RANGER_ALL])
    See([GOODCUTOFF.0.0.PALADIN_ALL])
    See([GOODCUTOFF.0.0.FIGHTER_ALL])
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(NearestEnemyOf(Myself))
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SecondNearestEnemyOf(Myself))
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(ThirdNearestEnemyOf(Myself))
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FourthNearestEnemyOf(Myself))
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FifthNearestEnemyOf(Myself))
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SixthNearestEnemyOf(Myself))
  HPGT(Nearestenemyof(Myself),19)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA909")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA909",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA907")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA907",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA906")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA906",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA904")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA904",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA903")
  See(Nearestenemyof(Myself))
  HPLT(Nearestenemyof(Myself),61)
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA903",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA901")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA901",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA812")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA812",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END


IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA806")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA806",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END


IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA801")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA801",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA712")
  OR(2)
  HPPercentLT(Myself,60)
  HPPercentLT(NearestAllyOf(Myself),60)
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA712",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA605")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA605",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA510")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA510",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA508")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA508",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player1)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player2)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player3)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player4)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player5)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player6)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See([GOODCUTOFF])
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !CheckSpellState(Nearestenemyof(Myself),MALISON)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_SoC","LOCALS")
  HaveSpellRES("C0SA712")
  Range([GOODCUTOFF],15)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_SoC","LOCALS",SIX_ROUNDS)
    SpellRES("C0SA712",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(NearestEnemyOf(Myself))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Kit(Nearestenemyof(Myself),Blackguard)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SecondNearestEnemyOf(Myself))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Kit(Nearestenemyof(Myself),Blackguard)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(ThirdNearestEnemyOf(Myself))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Kit(Nearestenemyof(Myself),Blackguard)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FourthNearestEnemyOf(Myself))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Kit(Nearestenemyof(Myself),Blackguard)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FifthNearestEnemyOf(Myself))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Kit(Nearestenemyof(Myself),Blackguard)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SixthNearestEnemyOf(Myself))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Kit(Nearestenemyof(Myself),Blackguard)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See([GOODCUTOFF])
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H21",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(SecondNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H21",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(ThirdNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H21",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(FourthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H21",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(FifthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H21",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(SixthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H21",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",Nearestenemyof(Myself))
END

IF
  See(NearestEnemyOf(Myself))
  HaveSpellRES("C0SA501")
  !GlobalTimerNotExpired("BD_TIMER_CNA","LOCALS")
  CheckStatLT(Nearestenemyof(Myself),50,RESISTCOLD)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !HasBounceEffects(Nearestenemyof(Myself))
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,75,SPELLFAILUREMAGE)
  RandomNumLT(14,11)
THEN
  RESPONSE #100
    SetGlobalTimer("BD_TIMER_CNA","LOCALS",ONE_ROUND)
    SpellRES("C0SA501",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA406")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  CheckStat(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA406",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([PC.0.0.FIGHTER_ALL])
  !Race(Nearestenemyof(Myself),ELF)
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([PC.0.0.FIGHTER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([PC.0.0.FIGHTER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([PC.0.0.RANGER_ALL])
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([PC.0.0.RANGER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([PC.0.0.RANGER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([PC.0.0.PALADIN_ALL])
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([PC.0.0.PALADIN_ALL]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([PC.0.0.PALADIN_ALL]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !StateCheck(Nearestenemyof(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  OR(4)
    See([GOODCUTOFF.0.0.BARD_ALL])
    See([GOODCUTOFF.0.0.DRUID_ALL])
    See([GOODCUTOFF.0.0.CLERIC_ALL])
    See([GOODCUTOFF.0.0.LONG_BOW])
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See([GOODCUTOFF])
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(SecondNearest([GOODCUTOFF]))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(ThirdNearest([GOODCUTOFF]))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(FourthNearest([GOODCUTOFF]))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(FifthNearest([GOODCUTOFF]))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(SixthNearest([GOODCUTOFF]))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Nearestenemyof(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA708")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  CheckStat(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA708",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.FIGHTER])
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.FIGHTER]))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.RANGER])
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.RANGER]))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.PALADIN])
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.PALADIN]))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.CLERIC])
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.CLERIC]))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.DRUID])
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.DRUID]))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,SANCTUARY)
  CheckStatGT(Nearestenemyof(Myself),9,SAVEVSWANDS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",Nearestenemyof(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See([GOODCUTOFF])
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See([GOODCUTOFF])
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(SecondNearest([GOODCUTOFF]))
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(ThirdNearest([GOODCUTOFF]))
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(FourthNearest([GOODCUTOFF]))
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(FifthNearest([GOODCUTOFF]))
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(SixthNearest([GOODCUTOFF]))
  !Class(Nearestenemyof(Myself),MONK)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_SLOWED)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquiped("NPPLAT",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(Nearestenemyof(Myself),-4,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See([PC])
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SecondNearest([PC]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  See(ThirdNearest([PC]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FourthNearest([PC]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FifthNearest([PC]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SixthNearest([PC]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See([GOODCUTOFF.HUMANOID])
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See([GOODCUTOFF.HUMANOID])
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),UNDEADHUNTER)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),UNDEADHUNTER)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),UNDEADHUNTER)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),UNDEADHUNTER)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),UNDEADHUNTER)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),UNDEADHUNTER)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL])
  !Class(Nearestenemyof(Myself),MONK)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(Nearestenemyof(Myself),MONK)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(Nearestenemyof(Myself),MONK)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.RANGER_ALL])
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID])
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SeventhNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(EighthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(NinthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(TenthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA302")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),15)
  !Range(NearestEnemyOf(Myself),15)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA302",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA307")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  General(Nearestenemyof(Myself),HUMANOID)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA307",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA305")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  General(Nearestenemyof(Myself),HUMANOID)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA305",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA308")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA308",Nearestenemyof(Myself))
  RESPONSE #25
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See([GOODCUTOFF])
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(SecondNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(ThirdNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(FourthNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(FifthNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(SixthNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See([GOODCUTOFF])
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(SecondNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(ThirdNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(FourthNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(FifthNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(SixthNearest([GOODCUTOFF]))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.FIGHTER])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.FIGHTER]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.RANGER])
  !Kit(Nearestenemyof(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.RANGER]))
  !Kit(Nearestenemyof(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.FIGHTER_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.FIGHTER_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.RANGER_ALL])
  !Kit(Nearestenemyof(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.RANGER_ALL]))
  !Kit(Nearestenemyof(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.PALADIN_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.PALADIN_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.THIEF_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.THIEF_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatGT(Nearestenemyof(Myself),5,STR)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA212")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA212",Nearestenemyof(Myself))
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See([GOODCUTOFF])
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !HasItem("MORSWORD",Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA209")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA209",Nearestenemyof(Myself))
  RESPONSE #25
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See([GOODCUTOFF])
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(SecondNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(ThirdNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(FourthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",Nearestenemyof(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(FifthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA101")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA101",Nearestenemyof(Myself))
  RESPONSE #25
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA112")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA112",Nearestenemyof(Myself))
  RESPONSE #25
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(SixthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),DEMONIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckSpellState(Nearestenemyof(Myself),RESIST_FEAR)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H32",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("HAMM11",Nearestenemyof(Myself))
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See([GOODCUTOFF])
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(SecondNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(ThirdNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(FourthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(FifthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(SixthNearest([GOODCUTOFF]))
  !General(Nearestenemyof(Myself),UNDEAD)
  !Race(Nearestenemyof(Myself),SLIME)
  !Race(Nearestenemyof(Myself),DEMONIC)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !StateCheck(Nearestenemyof(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(Nearestenemyof(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",Nearestenemyof(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL])
  !Class(Nearestenemyof(Myself),MONK)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(Nearestenemyof(Myself),MONK)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(Nearestenemyof(Myself),MONK)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.RANGER_ALL])
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA106")
  See(Nearestenemyof(Myself))
  !Range(Nearestenemyof(Myself),0)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA106",Nearestenemyof(Myself))
  RESPONSE #25
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID])
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SeventhNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(EighthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(NinthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(TenthNearest([GOODCUTOFF.HUMANOID]))
  !Class(Nearestenemyof(Myself),MONK)
  !Kit(Nearestenemyof(Myself),INQUISITOR)
  !Kit(Nearestenemyof(Myself),CAVALIER)
  !Race(Nearestenemyof(Myself),ELF)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_DISABLED)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStatGT(Nearestenemyof(Myself),3,SAVEVSSPELL)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(Nearestenemyof(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(Nearestenemyof(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",Nearestenemyof(Myself))
  !HasItemEquiped("HELM06",Nearestenemyof(Myself))
  !HasItemEquiped("NPCHAN",Nearestenemyof(Myself))
  !HasItemEquiped("SHLD25",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H14",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquipedReal("SPER07",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H35",Nearestenemyof(Myself))
  !HasItemEquipedReal("STAF11",Nearestenemyof(Myself))
  !HasItemEquipedReal("MISCBC",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H54",Nearestenemyof(Myself))
  !HasItemEquiped("IMOENHP1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  !See([GOODCUTOFF])
  Detect([GOODCUTOFF])
  Range(Nearestenemyof(Myself),12)
  !StateCheck(Nearestenemyof(Myself),STATE_SILENCED)
  !StateCheck(Nearestenemyof(Myself),STATE_NONDETECTION)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(Nearestenemyof(Myself),0,SAVEVSSPELL)
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
  CheckStat(Nearestenemyof(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",Nearestenemyof(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Myself)
END

IF
  Global("OH_Heal","LOCALS",0)
  Global("OH_Active","LOCALS",1)
  !Detect([GOODCUTOFF])
  InMyArea(Player1)
  !StateCheck(Myself,STATE_BLIND)
  !StateCheck(Player1,STATE_REALLY_DEAD)
  OR(2)
    RandomNum(5,1)
    CombatCounter(0)
THEN
  RESPONSE #100
    MoveToObject(Player1)
END

IF
  !Global("OH_Heal","LOCALS",1)
  Global("OH_Active","LOCALS",1)
  !See([GOODCUTOFF])
  RandomNum(2,1)
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  Global("OH_Heal","LOCALS",1)
  GlobalTimerNotExpired("OH_Cast","LOCALS")
  See([GOODCUTOFF])
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF
  Range(Nearestenemyof(Myself),5)
  See(Nearestenemyof(Myself))
  HaveSpellRES("spsd02")
THEN
  RESPONSE #100
	SpellRES("spsd02",Myself)
	SmallWait(5)
	RunAwayFrom(Nearestenemyof(Myself),10)
END

IF
  See(NearestEnemyOf(Myself))
  Range(Nearestenemyof(Myself),5)
THEN
  RESPONSE #100
    EquipMostDamagingMelee()
    AttackReevaluate(NearestEnemyOf(Myself),30)
END

IF
  See(NearestEnemyOf(Myself))
  IsWeaponRanged(Myself)
THEN
  RESPONSE #100
    AttackReevaluate(NearestEnemyOf(Myself),30)
END

IF
  See(NearestEnemyOf(Myself))
  !GlobalTimerNotExpired("bd_cast","locals")
THEN
  RESPONSE #100
    EquipRanged()
    AttackReevaluate(NearestEnemyOf(Myself),30)
END

IF
  See(NearestEnemyOf(Myself))
  Delay(2)
THEN
  RESPONSE #100
    EquipRanged()
END