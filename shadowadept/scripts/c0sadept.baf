IF
  !Allegiance(Myself,GOODCUTOFF)
  Global("OH_Active","LOCALS",0)
    AttackedBy([PC],DEFAULT)
THEN
  RESPONSE #100
    SetGlobal("OH_Active","LOCALS",1)
    SetGlobalTimer("OH_Rest","LOCALS",EIGHT_HOURS)
    Enemy()
END

IF
  !See(Nearestenemyof(Myself))
  OR(5)
    Global("OH_Active","LOCALS",0)
    !Allegiance(Myself,EVILCUTOFF)
    StateCheck(Myself,STATE_IMMOBILE)
    StateCheck(Myself,STATE_PANIC)
    StateCheck(Myself,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    NoAction()
END

IF
  !GlobalTimerNotExpired("OH_Rest","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Rest","LOCALS",EIGHT_HOURS)
    SetGlobal("OH_CHCntg","LOCALS",0)
    SetGlobal("OH_Cntg","LOCALS",0)
    SetGlobal("OH_Seq","LOCALS",0)
    SetGlobal("OH_MSeq","LOCALS",0)
    SetGlobal("OH_Trig","LOCALS",0)
    ApplySpell(Myself,RESTORE_FULL_HEALTH)
    Rest()
END

IF
  Global("OH_Active","LOCALS",1)
  Global("OH_CHCntg","LOCALS",0)
  ClassLevelGT(Myself,WIZARD,17)
  See(NearestEnemyOf(Myself))
THEN
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA807",Myself)
    ReallyForceSpellRES("C0SA712",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA704",Myself)
    ReallyForceSpellRES("C0SA809",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA610",Myself)
    ReallyForceSpellRES("C0SA603",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA811",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA801",Myself)
    ReallyForceSpellRES("C0SA802",Myself)
    Continue()
END

IF
  ClassLevelGT(Myself,WIZARD,13)
  See(Nearestenemyof(Myself))
  Global("SHADOWDOUBLE","LOCALS",0)
  HaveSpellRES("c0sa2")
THEN
  RESPONSE #100
    ReallyForceSpellRES("C0SA2",Myself)
    SetGlobal("SHADOWDOUBLE","LOCALS",1)
    Continue()
END

IF
  See(Nearestenemyof(Myself))
  Global("Prep","LOCALS",0)
THEN
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA412",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA401",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA306",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
    ReallyForceSpellRES("C0SA602",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    SetGlobal("Prep","LOCALS",1)
END

IF
  See(Nearestenemyof(Myself))
  HasItem("C0SApot1",Myself)
  Global("DrinkEbonshade","LOCALS",0)
THEN
  RESPONSE #100
	UseItem("C0SApot1",Myself)
	SetGlobalTimer("C0DrinkPotion","LOCALS",ONE_TURN)
    SetGlobal("DrinkEbonshade","LOCALS",1)
	Continue()
END

IF
  Allegiance(Myself,ENEMY)
  See(Nearestenemyof(Myself))
  !ClassLevelGT(Myself,WIZARD,15)
  HasItem("C0SApot1",Myself)
  GlobalTimerExpired("C0DrinkPotion","LOCALS")
THEN
  RESPONSE #100
	DisplayStringHead(Myself,~*quaffs a potion*~)
	UseItem("C0SApot1",Myself)
	SetGlobalTimer("C0DrinkPotion","LOCALS",ONE_TURN)
END
IF
  Global("OH_Active","LOCALS",1)
  Global("OH_Cntg","LOCALS",0)
  ClassLevelGT(Myself,WIZARD,11)
  HPPercentLT(Myself,51)
  !StateCheck(Myself,STATE_REALLY_DEAD)
THEN
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA402",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA413",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA412",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA602",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA603",Myself)
    Continue()
END

IF
  !CheckStatGT(Myself,0,AURACLEANSING)
  ClassLevelGT(Myself,WIZARD,15)
  Global("OH_Trig","LOCALS",0)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  Range([GOODCUTOFF],30)
THEN
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA512",Myself)
    ReallyForceSpellRES("C0SA505",Myself)
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    ReallyForceSpellRES("C0SA607",Myself)
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA610",Myself)
    ReallyForceSpellRES("C0SA610",Myself)
END

IF
  Global("OH_Seq","LOCALS",0)
  ClassLevelGT(Myself,WIZARD,13)
  CheckStatLT(Myself,1,STONESKINS)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #50
    SetGlobal("OH_Seq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Sequencer - Fired~) // 'Spell Sequencerâ€”Fired'
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA401",Myself)
    ReallyForceSpellRES("C0SA405",Myself)
  RESPONSE #50
    SetGlobal("OH_Seq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Sequencer - Fired~) // 'Spell Sequencerâ€”Fired'
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    ReallyForceSpellRES("C0SA412",Myself)
END

IF
  CheckStatLT(Myself,1,STONESKINS)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  !StateCheck(Myself,STATE_INVISIBLE)
  !Global("dvgldust","LOCALS",1)
  HaveSpellRES("C0SA213")
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA213",Myself)
END

IF
  CheckStatLT(Myself,1,STONESKINS)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  !StateCheck(Myself,STATE_INVISIBLE)
  !Global("dvgldust","LOCALS",1)
  !HaveSpellRES("C0SA213")
  HasItem("POTN10",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN10",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  !CheckStatGT(Myself,0,AURACLEANSING)
  Range([GOODCUTOFF],30)
  HaveSpellRES("C0SA902")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_TStop","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA902",Myself)
END

IF
  !CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SAhla1")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  Range([GOODCUTOFF],30)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SAhla1",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  HaveSpellRES("C0SA603")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  Range([GOODCUTOFF],30)
  OR(3)
    CheckStatLT(Myself,1,STONESKINS)
    AttackedBy([ANYONE],DEFAULT)
    Range([GOODCUTOFF],4)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA603",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpellRES("C0SA402")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA402",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpellRES("C0SA412")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA412",Myself)
END

IF
  !CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  Global("OH_MSeq","LOCALS",0)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  !CheckStatGT(LastSeenBy,0,STONESKINS)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #50
    SetGlobal("OH_MSeq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetSequence(SEQ_CAST)
    DisplayString(Myself,~Minor Sequencer Activated~) // 'Minor Sequencer Activated'
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA110",Myself)
  RESPONSE #50
    SetGlobal("OH_MSeq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetSequence(SEQ_CAST)
    DisplayString(Myself,~Minor Sequencer Activated~) // 'Minor Sequencer Activated'
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA208",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  HaveSpellRES("C0SA201")
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA201",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  HaveSpellRES("C0SA413")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA413",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  HaveSpellRES("C0SA502")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA502",Myself)
END

IF
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  Allegiance(Myself,EVILCUTOFF)
  !AreaType(OUTDOOR)
  !Range(NearestEnemyOf(Myself),30)
  Range(NearestDoor,15)
  OpenState(NearestDoor,FALSE)
THEN
  RESPONSE #100
    MoveToObject(NearestDoor)
    OpenDoor(NearestDoor)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA706")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA706",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA407")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA407",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA207")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA207",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HPPercentLT(Myself,80)
  HaveSpellRES("C0SA304")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA304",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA503")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  OR(4)
    CheckSpellState(LastSeenBy,BUFF_PRO_WEAPONS)
    CheckStatGT(LastSeenBy,0,STONESKINS)
    CheckSpellState(LastSeenBy,BUFF_PRO_EFFECTS)
    CheckSpellState(LastSeenBy,BUFF_PRO_DAMAGE)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA503",LastSeenBy)
  RESPONSE #100
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA606")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckSpellState(LastSeenBy,BUFF_PRO_SPELLS)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA606",LastSeenBy)
  RESPONSE #100
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA704")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA704",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  OR(2)
  !AreaType(OUTDOOR)
  TimeOfDay(NIGHT)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA512")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA512",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA512")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA512",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA404")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA404",Myself)
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player1,90)
  See(Player1)
  !StateCheck(Player1,STATE_REALLY_DEAD)
  !StateCheck(Player1,STATE_NOT_TARGETABLE)
  !StateCheck(Player1,STATE_HARMLESS)
  !CheckStatGT(Player1,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player1,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player1,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player1,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player1,0,CLERIC_FREE_ACTION)
  !CheckStat(Player1,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player1,1,SCRIPTINGSTATE4)
  !HasItemEquipedReal("NPSW01",Player1)
  !HasItemEquipedReal("SW1H27",Player1)
  !HasItemEquiped("RING09",Player1)
  !HasItemEquipedReal("SW2H06",Player1)
  CheckStatLT(Player1,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player1)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player2,90)
  See(Player2)
  !StateCheck(Player2,STATE_REALLY_DEAD)
  !StateCheck(Player2,STATE_NOT_TARGETABLE)
  !StateCheck(Player2,STATE_HARMLESS)
  !CheckStatGT(Player2,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player2,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player2,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player2,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player2,0,CLERIC_FREE_ACTION)
  !CheckStat(Player2,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player2,1,SCRIPTINGSTATE4)
  !CheckStat(Player2,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player2)
  !HasItemEquipedReal("SW1H27",Player2)
  !HasItemEquiped("RING09",Player2)
  !HasItemEquipedReal("SW2H06",Player2)
  CheckStatLT(Player2,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player2)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player3,90)
  See(Player3)
  !StateCheck(Player3,STATE_REALLY_DEAD)
  !StateCheck(Player3,STATE_NOT_TARGETABLE)
  !StateCheck(Player3,STATE_HARMLESS)
  !CheckStatGT(Player3,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player3,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player3,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player3,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player3,0,CLERIC_FREE_ACTION)
  !CheckStat(Player3,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player3,1,SCRIPTINGSTATE4)
  !CheckStat(Player3,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player3)
  !HasItemEquipedReal("SW1H27",Player3)
  !HasItemEquiped("RING09",Player3)
  !HasItemEquipedReal("SW2H06",Player3)
  CheckStatLT(Player3,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player3)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player4,90)
  See(Player4)
  !StateCheck(Player4,STATE_REALLY_DEAD)
  !StateCheck(Player4,STATE_NOT_TARGETABLE)
  !StateCheck(Player4,STATE_HARMLESS)
  !CheckStatGT(Player4,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player4,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player4,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player4,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player4,0,CLERIC_FREE_ACTION)
  !CheckStat(Player4,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player4,1,SCRIPTINGSTATE4)
  !CheckStat(Player4,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player4)
  !HasItemEquipedReal("SW1H27",Player4)
  !HasItemEquiped("RING09",Player4)
  !HasItemEquipedReal("SW2H06",Player4)
  CheckStatLT(Player4,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player4)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player5,90)
  See(Player5)
  !StateCheck(Player5,STATE_REALLY_DEAD)
  !StateCheck(Player5,STATE_NOT_TARGETABLE)
  !StateCheck(Player5,STATE_HARMLESS)
  !CheckStatGT(Player5,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player5,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player5,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player5,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player5,0,CLERIC_FREE_ACTION)
  !CheckStat(Player5,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player5,1,SCRIPTINGSTATE4)
  !CheckStat(Player5,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player5)
  !HasItemEquipedReal("SW1H27",Player5)
  !HasItemEquiped("RING09",Player5)
  !HasItemEquipedReal("SW2H06",Player5)
  CheckStatLT(Player5,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player5)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Player6,90)
  See(Player6)
  !StateCheck(Player6,STATE_REALLY_DEAD)
  !StateCheck(Player6,STATE_NOT_TARGETABLE)
  !StateCheck(Player6,STATE_HARMLESS)
  !CheckStatGT(Player6,0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Player6,0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Player6,0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Player6,0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Player6,0,CLERIC_FREE_ACTION)
  !CheckStat(Player6,2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Player6,1,SCRIPTINGSTATE4)
  !CheckStat(Player6,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquipedReal("NPSW01",Player6)
  !HasItemEquipedReal("SW1H27",Player6)
  !HasItemEquiped("RING09",Player6)
  !HasItemEquipedReal("SW2H06",Player6)
  CheckStatLT(Player6,50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Player6)
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See([GOODCUTOFF])
  HPLT(LastSeenBy(Myself),90)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),9,LEVEL)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.PALADIN_ALL])
  Kit(LastSeenBy(Myself),INQUISITOR)
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.LONG_BOW])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.LONG_BOW]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([PC.0.0.LONG_BOW]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.DRUID_ALL])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.DRUID_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([PC.0.0.DRUID_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.CLERIC_ALL])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.CLERIC_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([PC.0.0.CLERIC_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([PC.0.0.BARD_ALL])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([PC.0.0.BARD_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See([GOODCUTOFF])
  HPLT(LastSeenBy(Myself),20)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SecondNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(ThirdNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FourthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FifthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SixthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Player1,2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA608")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  StateCheck(LastSeenBy,STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA611")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  StateCheck(LastSeenBy,STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA611",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA708")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy,STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA708",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA710")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA710",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA610")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA610",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  OR(3)
    See([GOODCUTOFF.0.0.RANGER_ALL])
    See([GOODCUTOFF.0.0.PALADIN_ALL])
    See([GOODCUTOFF.0.0.FIGHTER_ALL])
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(NearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SecondNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(ThirdNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FourthNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FifthNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SixthNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA909")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA909",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA907")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA907",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA906")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA906",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA904")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA904",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA903")
  See(LastSeenBy)
  HPLT(LastSeenBy,61)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA903",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA901")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA901",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA812")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA812",LastSeenBy)
  RESPONSE #50
    Continue()
END


IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA806")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA806",LastSeenBy)
  RESPONSE #50
    Continue()
END


IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA801")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA801",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA712")
  OR(2)
  HPPercentLT(Myself,60)
  HPPercentLT(NearestAllyOf(Myself),60)
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA712",Myself)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA605")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA605",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA510")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA510",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA508")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA508",LastSeenBy)
  RESPONSE #50
    Continue()
END
IF
	!CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("OH_Cast","LOCALS")
	HaveSpellRES("C0SA311")  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See([GOODCUTOFF.0.MIST.0.0.SUMMONED])
	HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(Player1,STATE_DISABLED)
	!StateCheck(Player2,STATE_DISABLED)
	!StateCheck(Player3,STATE_DISABLED)
	!StateCheck(Player4,STATE_DISABLED)
	!StateCheck(Player5,STATE_DISABLED)
	!StateCheck(Player6,STATE_DISABLED)
THEN
	RESPONSE #100
		SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
		SpellRES("C0SA311",LastSeenBy(Myself))  // SPWI302.SPL (Remove Magic)
END
IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player1)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player2)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player3)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player4)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player5)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player6)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See([GOODCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_SoC","LOCALS")
  HaveSpellRES("C0SA712")
  Range([GOODCUTOFF],15)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_SoC","LOCALS",SIX_ROUNDS)
    SpellRES("C0SA712",Myself)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(NearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SecondNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(ThirdNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FourthNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FifthNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SixthNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(SecondNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(ThirdNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(FourthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(FifthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(SixthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF
  See(NearestEnemyOf(Myself))
  HaveSpellRES("C0SA501")
  !GlobalTimerNotExpired("BD_TIMER_CNA","LOCALS")
  CheckStatLT(LastSeenBy(Myself),50,RESISTCOLD)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !HasBounceEffects(LastSeenBy(Myself))
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,75,SPELLFAILUREMAGE)
  RandomNumLT(14,11)
THEN
  RESPONSE #100
    SetGlobalTimer("BD_TIMER_CNA","LOCALS",ONE_ROUND)
    SpellRES("C0SA501",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA406")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckStat(LastSeenBy,0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA406",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([PC.0.0.FIGHTER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([PC.0.0.FIGHTER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([PC.0.0.FIGHTER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([PC.0.0.RANGER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([PC.0.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([PC.0.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([PC.0.0.PALADIN_ALL])
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([PC.0.0.PALADIN_ALL]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([PC.0.0.PALADIN_ALL]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  OR(4)
    See([GOODCUTOFF.0.0.BARD_ALL])
    See([GOODCUTOFF.0.0.DRUID_ALL])
    See([GOODCUTOFF.0.0.CLERIC_ALL])
    See([GOODCUTOFF.0.0.LONG_BOW])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See([GOODCUTOFF])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(SecondNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(ThirdNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(FourthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(FifthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(SixthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  OR(4)
    See([GOODCUTOFF.0.0.BARD_ALL])
    See([GOODCUTOFF.0.0.DRUID_ALL])
    See([GOODCUTOFF.0.0.CLERIC_ALL])
    See([GOODCUTOFF.0.0.LONG_BOW])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  See([GOODCUTOFF])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  See(SecondNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  See(ThirdNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  See(FourthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  See(FifthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA608")
  See(SixthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  OR(4)
    See([GOODCUTOFF.0.0.BARD_ALL])
    See([GOODCUTOFF.0.0.DRUID_ALL])
    See([GOODCUTOFF.0.0.CLERIC_ALL])
    See([GOODCUTOFF.0.0.LONG_BOW])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  See([GOODCUTOFF])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  See(SecondNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  See(ThirdNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  See(FourthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  See(FifthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA609")
  See(SixthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA609",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA705")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckStat(LastSeenBy,0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA705",LastSeenBy)
  RESPONSE #50
    Continue()
END
IF
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA708")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckStat(LastSeenBy,0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA708",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.FIGHTER])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.FIGHTER]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.RANGER])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.RANGER]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.PALADIN])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.PALADIN]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.CLERIC])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.CLERIC]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([PC.0.0.DRUID])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([PC.0.0.DRUID]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See([GOODCUTOFF])
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See([GOODCUTOFF])
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(SecondNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(ThirdNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(FourthNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(FifthNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(SixthNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See([PC])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SecondNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  See(ThirdNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FourthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FifthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SixthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See([GOODCUTOFF.HUMANOID])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL])
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.RANGER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID])
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SeventhNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(EighthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(NinthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(TenthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA302")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),15)
  !Range(NearestEnemyOf(Myself),15)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA302",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA307")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  General(LastSeenBy,HUMANOID)
  !StateCheck(LastSeenBy,STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA305")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  General(LastSeenBy,HUMANOID)
  !StateCheck(LastSeenBy,STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA308")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA308",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See([GOODCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(SecondNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(ThirdNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(FourthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(FifthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(SixthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See([GOODCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(SecondNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(ThirdNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(FourthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(FifthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(SixthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.FIGHTER])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.FIGHTER]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.RANGER])
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.RANGER]))
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.FIGHTER_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.FIGHTER_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.RANGER_ALL])
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.RANGER_ALL]))
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.PALADIN_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.PALADIN_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([PC.0.0.THIEF_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([PC.0.0.THIEF_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA212")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy,STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA212",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA209")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA209",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(SecondNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(ThirdNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(FourthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(FifthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA101")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA101",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA112")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA112",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(SixthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(SecondNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(ThirdNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(FourthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(FifthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(SixthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL])
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.RANGER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA106")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA106",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID])
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SeventhNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(EighthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(NinthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(TenthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NPCHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  !See([GOODCUTOFF])
  Detect([GOODCUTOFF])
  Range(LastSeenBy(Myself),12)
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Myself)
END

IF
  Global("OH_Heal","LOCALS",0)
  Global("OH_Active","LOCALS",1)
  !Detect([GOODCUTOFF])
  InMyArea(Player1)
  !StateCheck(Myself,STATE_BLIND)
  !StateCheck(Player1,STATE_REALLY_DEAD)
  OR(2)
    RandomNum(5,1)
    CombatCounter(0)
THEN
  RESPONSE #100
    MoveToObject(Player1)
END

IF
  !Global("OH_Heal","LOCALS",1)
  Global("OH_Active","LOCALS",1)
  !See([GOODCUTOFF])
  RandomNum(2,1)
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  Global("OH_Heal","LOCALS",1)
  GlobalTimerNotExpired("OH_Cast","LOCALS")
  See([GOODCUTOFF])
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF
  Range(Nearestenemyof(Myself),5)
  See(Nearestenemyof(Myself))
  HPPercentLT(Myself,85)
  HaveSpellRES("spsd02")
  OR(2)
  HasItem("POTN10",Myself)
  HasItem("POTN52",Myself)
THEN
  RESPONSE #100
	SpellRES("spsd02",Myself)
	SmallWait(5)
	RunAwayFrom(Nearestenemyof(Myself),10)
	Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(5)
    Global("OH_Active","LOCALS",0)
    !Allegiance(Myself,EVILCUTOFF)
    StateCheck(Myself,STATE_IMMOBILE)
    StateCheck(Myself,STATE_PANIC)
    StateCheck(Myself,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    NoAction()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Rest","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Rest","LOCALS",EIGHT_HOURS)
    SetGlobal("OH_CHCntg","LOCALS",0)
    SetGlobal("OH_Cntg","LOCALS",0)
    SetGlobal("OH_Seq","LOCALS",0)
    SetGlobal("OH_MSeq","LOCALS",0)
    SetGlobal("OH_Trig","LOCALS",0)
    ApplySpell(Myself,RESTORE_FULL_HEALTH)
    Rest()
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Active","LOCALS",1)
  Global("OH_CHCntg","LOCALS",0)
  ClassLevelGT(Myself,WIZARD,17)
  See(NearestEnemyOf(Myself))
THEN
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA807",Myself)
    ReallyForceSpellRES("C0SA712",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA704",Myself)
    ReallyForceSpellRES("C0SA809",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA610",Myself)
    ReallyForceSpellRES("C0SA603",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA811",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_CHCntg","LOCALS",1)
    SetGlobalTimer("OH_SoC","LOCALS",FIVE_ROUNDS)
    DisplayString(Myself,~Chain Contingency~) // 'Chain Contingency'
    ReallyForceSpellRES("C0SA805",Myself)
    ReallyForceSpellRES("C0SA801",Myself)
    ReallyForceSpellRES("C0SA802",Myself)
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  See(Nearestenemyof(Myself))
  Global("Prep","LOCALS",0)
THEN
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA412",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA401",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA306",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
    ReallyForceSpellRES("C0SA602",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    SetGlobal("Prep","LOCALS",1)
  RESPONSE #20
    ReallyForceSpellRES("C0SA1",Myself)
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    SetGlobal("Prep","LOCALS",1)
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Active","LOCALS",1)
  Global("OH_Cntg","LOCALS",0)
  ClassLevelGT(Myself,WIZARD,11)
  HPPercentLT(Myself,51)
  !StateCheck(Myself,STATE_REALLY_DEAD)
THEN
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA402",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA413",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA412",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA602",Myself)
    Continue()
  RESPONSE #20
    SetGlobal("OH_Cntg","LOCALS",1)
    DisplayString(Myself,~Contingency Active~) // 'Contingency Active'
    ReallyForceSpellRES("C0SA603",Myself)
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Heal","LOCALS",1)
  OR(2)
    HPPercentGT(Myself,84)
    !HasItem("POTN52",Myself)
THEN
  RESPONSE #100
    SetGlobal("OH_Heal","LOCALS",0)
END

IF Allegiance(Myself,GOODCUTOFF)
  HPPercentLT(Myself,85)
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN52",Myself)
THEN
  RESPONSE #100
    SetGlobal("OH_Heal","LOCALS",1)
END

IF Allegiance(Myself,GOODCUTOFF)
  See(Nearestenemyof(Myself))
  !ClassLevelGT(Myself,WIZARD,15)
  HasItem("C0SApot1",Myself)
  Global("DrinkEbonshade","LOCALS",0)
THEN
  RESPONSE #100
	UseItem("C0SApot1",Myself)
	SetGlobalTimer("C0DrinkPotion","LOCALS",ONE_TURN)
    SetGlobal("DrinkEbonshade","LOCALS",1)
	Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  Allegiance(Myself,ENEMY)
  See(Nearestenemyof(Myself))
  !ClassLevelGT(Myself,WIZARD,15)
  HasItem("C0SApot1",Myself)
  GlobalTimerExpired("C0DrinkPotion","LOCALS")
THEN
  RESPONSE #100
	DisplayStringHead(Myself,~*quaffs a potion*~)
	UseItem("C0SApot1",Myself)
	SetGlobalTimer("C0DrinkPotion","LOCALS",ONE_TURN)
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Heal","LOCALS",1)
  !StateCheck(Myself,STATE_INVISIBLE)
  !Global("dvgldust","LOCALS",1)
  HasItem("POTN10",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN10",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Heal","LOCALS",1)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("POTN52",Myself)
  HPPercentLT(Myself,85)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN52",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF Allegiance(Myself,GOODCUTOFF)
  !CheckStatGT(Myself,0,AURACLEANSING)
  ClassLevelGT(Myself,WIZARD,15)
  Global("OH_Trig","LOCALS",0)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  Range([GOODCUTOFF],30)
THEN
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA512",Myself)
    ReallyForceSpellRES("C0SA505",Myself)
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    ReallyForceSpellRES("C0SA511",Myself)
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA601",Myself)
    ReallyForceSpellRES("C0SA607",Myself)
  RESPONSE #25
    SetGlobal("OH_Trig","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Trigger~) // 'Spell Trigger'
    ReallyForceSpellRES("C0SA603",Myself)
    ReallyForceSpellRES("C0SA610",Myself)
    ReallyForceSpellRES("C0SA610",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Seq","LOCALS",0)
  ClassLevelGT(Myself,WIZARD,13)
  CheckStatLT(Myself,1,STONESKINS)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #50
    SetGlobal("OH_Seq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Sequencer - Fired~) // 'Spell Sequencerâ€”Fired'
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA401",Myself)
    ReallyForceSpellRES("C0SA405",Myself)
  RESPONSE #50
    SetGlobal("OH_Seq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    DisplayString(Myself,~Spell Sequencer - Fired~) // 'Spell Sequencerâ€”Fired'
    ReallyForceSpellRES("C0SA402",Myself)
    ReallyForceSpellRES("C0SA404",Myself)
    ReallyForceSpellRES("C0SA412",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  CheckStatLT(Myself,1,STONESKINS)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  !StateCheck(Myself,STATE_INVISIBLE)
  !Global("dvgldust","LOCALS",1)
  HasItem("POTN10",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN10",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  !CheckStatGT(Myself,0,AURACLEANSING)
  Range([GOODCUTOFF],30)
  HaveSpellRES("C0SA902")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_TStop","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA902",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  !CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SAhla1")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  Range([GOODCUTOFF],30)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SAhla1",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  HaveSpellRES("C0SA603")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  Range([GOODCUTOFF],30)
  OR(3)
    CheckStatLT(Myself,1,STONESKINS)
    AttackedBy([ANYONE],DEFAULT)
    Range([GOODCUTOFF],4)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA603",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpellRES("C0SA402")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA402",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpellRES("C0SA412")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA412",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  !CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  Global("OH_MSeq","LOCALS",0)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  !CheckStatGT(LastSeenBy,0,STONESKINS)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #50
    SetGlobal("OH_MSeq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetSequence(SEQ_CAST)
    DisplayString(Myself,~Minor Sequencer Activated~) // 'Minor Sequencer Activated'
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA110",Myself)
  RESPONSE #50
    SetGlobal("OH_MSeq","LOCALS",1)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetSequence(SEQ_CAST)
    DisplayString(Myself,~Minor Sequencer Activated~) // 'Minor Sequencer Activated'
    ReallyForceSpellRES("C0SA201",Myself)
    ReallyForceSpellRES("C0SA208",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  HaveSpellRES("C0SA201")
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA201",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  HaveSpellRES("C0SA413")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA413",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  HaveSpellRES("C0SA502")
  !CheckStatGT(Player1,0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA502",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  Allegiance(Myself,EVILCUTOFF)
  !AreaType(OUTDOOR)
  !Range(NearestEnemyOf(Myself),30)
  Range(NearestDoor,15)
  OpenState(NearestDoor,FALSE)
THEN
  RESPONSE #100
    MoveToObject(NearestDoor)
    OpenDoor(NearestDoor)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA706")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA706",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA407")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA407",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  OR(2)
  CheckStatLT(Myself,10,CON)
  HPPercentLT(Myself,50)
  HaveSpellRES("C0SA207")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA207",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HPPercentLT(Myself,80)
  HaveSpellRES("C0SA304")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA304",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA503")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  OR(4)
    CheckSpellState(LastSeenBy,BUFF_PRO_WEAPONS)
    CheckStatGT(LastSeenBy,0,STONESKINS)
    CheckSpellState(LastSeenBy,BUFF_PRO_EFFECTS)
    CheckSpellState(LastSeenBy,BUFF_PRO_DAMAGE)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA503",LastSeenBy)
  RESPONSE #100
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA606")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckSpellState(LastSeenBy,BUFF_PRO_SPELLS)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA606",LastSeenBy)
  RESPONSE #100
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA704")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA704",Myself)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  OR(2)
  !AreaType(OUTDOOR)
  TimeOfDay(NIGHT)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA711")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA711",Myself)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  OR(2)
  !AreaType(OUTDOOR)
  TimeOfDay(NIGHT)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA512")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA512",Myself)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  !Allegiance(Myself,GOODBUTBLUE)
  Range(NearestEnemyOf(Myself),30)
  HaveSpellRES("C0SA404")
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA404",Myself)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  HPLT(Nearestenemyof(Myself),90)
  See(Nearestenemyof(Myself))
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  !StateCheck(Nearestenemyof(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(Nearestenemyof(Myself),STATE_HARMLESS)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(Nearestenemyof(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(Nearestenemyof(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(Nearestenemyof(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(Nearestenemyof(Myself),1,SCRIPTINGSTATE4)
  !HasItemEquipedReal("NPSW01",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW1H27",Nearestenemyof(Myself))
  !HasItemEquiped("RING09",Nearestenemyof(Myself))
  !HasItemEquipedReal("SW2H06",Nearestenemyof(Myself))
  CheckStatLT(Nearestenemyof(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",Nearestenemyof(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA703")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See([GOODCUTOFF])
  HPLT(LastSeenBy(Myself),90)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),9,LEVEL)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA703",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([EVILCUTOFF.0.0.PALADIN_ALL])
  Kit(LastSeenBy(Myself),INQUISITOR)
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([EVILCUTOFF.0.0.LONG_BOW])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([EVILCUTOFF.0.0.LONG_BOW]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([EVILCUTOFF.0.0.LONG_BOW]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([EVILCUTOFF.0.0.DRUID_ALL])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([EVILCUTOFF.0.0.DRUID_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([EVILCUTOFF.0.0.DRUID_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([EVILCUTOFF.0.0.CLERIC_ALL])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([EVILCUTOFF.0.0.CLERIC_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(ThirdNearest([EVILCUTOFF.0.0.CLERIC_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See([EVILCUTOFF.0.0.BARD_ALL])
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    CheckStatGT(Myself,0,AURACLEANSING)
    !GlobalTimerNotExpired("OH_PWR","LOCALS")
  HaveSpellRES("C0SA604")
  See(SecondNearest([EVILCUTOFF.0.0.BARD_ALL]))
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_PWR","LOCALS",TWO_ROUNDS)
    SpellRES("C0SA604",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See([GOODCUTOFF])
  HPLT(LastSeenBy(Myself),20)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SecondNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(ThirdNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FourthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FifthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("BD_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA204")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SixthNearest([GOODCUTOFF]))
  OR(2)
  HPLT(LastSeenBy(Myself),20)
  ClassLevelGT(Myself,WIZARD,9)
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(Nearestenemyof(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("MORSWORD",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA204",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA608")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  StateCheck(LastSeenBy,STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA608",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA611")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  StateCheck(LastSeenBy,STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA611",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA708")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy,STATE_SLEEPING)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA708",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA710")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA710",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA610")
  See(LastSeenBy)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA610",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF
	GlobalGT("OH_CAST","LOCALS",2)
	HaveSpellRES("C0SA702")  // SPWI714.SPL (Prismatic Spray)
THEN
	RESPONSE #70
		SpellRES("C0SA702",LastSeenBy(Myself))  // SPWI714.SPL (Prismatic Spray)
		SetGlobal("OH_CAST","LOCALS",0)
	RESPONSE #30
		Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  OR(3)
    See([GOODCUTOFF.0.0.RANGER_ALL])
    See([GOODCUTOFF.0.0.PALADIN_ALL])
    See([GOODCUTOFF.0.0.FIGHTER_ALL])
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(NearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SecondNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(ThirdNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FourthNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(FifthNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Maze","LOCALS")
  HaveSpellRES("C0SA803")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  See(SixthNearestEnemyOf(Myself))
  HPGT(LastSeenBy(Myself),19)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Maze","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA803",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA909")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA909",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA907")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA907",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA906")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA906",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA904")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA904",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA903")
  See(LastSeenBy)
  HPLT(LastSeenBy,61)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA903",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA901")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA901",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA812")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA812",LastSeenBy)
  RESPONSE #50
    Continue()
END


IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA806")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA806",LastSeenBy)
  RESPONSE #50
    Continue()
END


IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA801")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA801",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA712")
  OR(2)
  HPPercentLT(Myself,60)
  HPPercentLT(NearestAllyOf(Myself),60)
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA712",Myself)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA605")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),13)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA605",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA510")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA510",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA508")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA508",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player1)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player2)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player3)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player4)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player5)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See(Player6)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_Malison","LOCALS")
  HaveSpellRES("C0SA403")
  See([GOODCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !CheckSpellState(LastSeenBy(Myself),MALISON)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_Malison","LOCALS",THREE_ROUNDS)
    SpellRES("C0SA403",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  !GlobalTimerNotExpired("OH_SoC","LOCALS")
  HaveSpellRES("C0SA712")
  Range([GOODCUTOFF],15)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SetGlobalTimer("OH_SoC","LOCALS",SIX_ROUNDS)
    SpellRES("C0SA712",Myself)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(NearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SecondNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(ThirdNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FourthNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FifthNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SixthNearestEnemyOf(Myself))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Kit(LastSeenBy(Myself),Blackguard)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    RemoveSpellRES("C0SA202")
    SpellNoDecRES("C0SA202",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(SecondNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(ThirdNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(FourthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(FifthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA505")
  See(SixthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("LEAT20",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H21",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA505",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  See(NearestEnemyOf(Myself))
  HaveSpellRES("C0SA501")
  !GlobalTimerNotExpired("BD_TIMER_CNA","LOCALS")
  CheckStatLT(LastSeenBy(Myself),50,RESISTCOLD)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !HasBounceEffects(LastSeenBy(Myself))
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,75,SPELLFAILUREMAGE)
  RandomNumLT(14,11)
THEN
  RESPONSE #100
    SetGlobalTimer("BD_TIMER_CNA","LOCALS",ONE_ROUND)
    SpellRES("C0SA501",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA406")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckStat(LastSeenBy,0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA406",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([EVILCUTOFF.0.0.FIGHTER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([EVILCUTOFF.0.0.FIGHTER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([EVILCUTOFF.0.0.FIGHTER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([EVILCUTOFF.0.0.RANGER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([EVILCUTOFF.0.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([EVILCUTOFF.0.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([EVILCUTOFF.0.0.PALADIN_ALL])
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([EVILCUTOFF.0.0.PALADIN_ALL]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([EVILCUTOFF.0.0.PALADIN_ALL]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  OR(4)
    See([GOODCUTOFF.0.0.BARD_ALL])
    See([GOODCUTOFF.0.0.DRUID_ALL])
    See([GOODCUTOFF.0.0.CLERIC_ALL])
    See([GOODCUTOFF.0.0.LONG_BOW])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See([GOODCUTOFF])
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(SecondNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(ThirdNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(FourthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(FifthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA410")
  See(SixthNearest([GOODCUTOFF]))
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
  !HasItemEquiped("CLCK26",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA410",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("bd_cast","locals")
  HaveSpellRES("C0SA708")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  CheckStat(LastSeenBy,0,WIZARD_SPELL_TURNING)
THEN
  RESPONSE #100
    SetGlobalTimer("bd_cast","locals",ONE_ROUND)
    SpellRES("C0SA708",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([EVILCUTOFF.0.0.FIGHTER])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([EVILCUTOFF.0.0.FIGHTER]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([EVILCUTOFF.0.0.RANGER])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([EVILCUTOFF.0.0.RANGER]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([EVILCUTOFF.0.0.PALADIN])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([EVILCUTOFF.0.0.PALADIN]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([EVILCUTOFF.0.0.CLERIC])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([EVILCUTOFF.0.0.CLERIC]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See([EVILCUTOFF.0.0.DRUID])
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("C0SAWAN6",Myself)
  See(SecondNearest([EVILCUTOFF.0.0.DRUID]))
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
  CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("C0SAWAN6",LastSeenBy(Myself))
    DisplayStringHead(Myself,~*uses a wand*~) // '*uses a wand*'
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See([GOODCUTOFF])
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See([GOODCUTOFF])
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(SecondNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(ThirdNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(FourthNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(FifthNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA303")
  See(SixthNearest([GOODCUTOFF]))
  !Class(LastSeenBy(Myself),MONK)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_SLOWED)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquiped("NPPLAT",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA303",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See([EVILCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SecondNearest([EVILCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  See(ThirdNearest([EVILCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FourthNearest([EVILCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(FifthNearest([EVILCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See(SixthNearest([EVILCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See([GOODCUTOFF.HUMANOID])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA408")
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA408",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See([GOODCUTOFF.HUMANOID])
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA307")
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !HasItemEquiped("RING09",LastSeenBy(Myself))
  !HasItemEquipedReal("NPSW01",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H27",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H06",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL])
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.RANGER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID])
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SeventhNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(EighthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(NinthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA305")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(TenthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA302")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  Range(NearestAllyOf(Myself),15)
  !Range(NearestEnemyOf(Myself),15)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA302",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA307")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  General(LastSeenBy,HUMANOID)
  !StateCheck(LastSeenBy,STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA307",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA305")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  General(LastSeenBy,HUMANOID)
  !StateCheck(LastSeenBy,STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA305",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA308")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA308",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See([GOODCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(SecondNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(ThirdNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(FourthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(FifthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  See(SixthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See([GOODCUTOFF])
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(SecondNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(ThirdNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(FourthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(FifthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA108")
  See(SixthNearest([GOODCUTOFF]))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA108",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([EVILCUTOFF.0.0.FIGHTER])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([EVILCUTOFF.0.0.FIGHTER]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([EVILCUTOFF.0.0.RANGER])
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([EVILCUTOFF.0.0.RANGER]))
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([EVILCUTOFF.0.0.FIGHTER_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([EVILCUTOFF.0.0.FIGHTER_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([EVILCUTOFF.0.0.RANGER_ALL])
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([EVILCUTOFF.0.0.RANGER_ALL]))
  !Kit(LastSeenBy(Myself),FERALAN)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([EVILCUTOFF.0.0.PALADIN_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([EVILCUTOFF.0.0.PALADIN_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See([EVILCUTOFF.0.0.THIEF_ALL])
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA210")
  See(SecondNearest([EVILCUTOFF.0.0.THIEF_ALL]))
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatGT(LastSeenBy(Myself),5,STR)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA210",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA212")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
  !StateCheck(LastSeenBy,STATE_DISABLED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA212",LastSeenBy)
  RESPONSE #50
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA202")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !HasItem("MORSWORD",LastSeenBy(Myself))
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA202",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA209")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA209",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(SecondNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(ThirdNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(FourthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(FifthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA101")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA101",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA112")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA112",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  OR(2)
    !GlobalTimerNotExpired("OH_Cast","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  HaveSpellRES("C0SA111")
  See(SixthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),DEMONIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !HasItemEquiped("CLCK30",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("HAMM11",LastSeenBy(Myself))
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA111",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See([GOODCUTOFF])
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(SecondNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(ThirdNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(FourthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(FifthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA103")
  See(SixthNearest([GOODCUTOFF]))
  !General(LastSeenBy(Myself),UNDEAD)
  !Race(LastSeenBy(Myself),SLIME)
  !Race(LastSeenBy(Myself),DEMONIC)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
  !StateCheck(LastSeenBy(Myself),STATE_BLIND)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA103",LastSeenBy(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL])
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.FIGHTER_ALL]))
  !Class(LastSeenBy(Myself),MONK)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID.0.RANGER_ALL])
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_CAST","locals")
  HaveSpellRES("C0SA106")
  See(LastSeenBy)
  !Range(LastSeenBy,0)
  !StateCheck(LastSeenBy,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_CAST","locals",ONE_ROUND)
    SpellRES("C0SA106",LastSeenBy)
  RESPONSE #25
    Continue()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID.0.RANGER_ALL]))
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See([GOODCUTOFF.HUMANOID])
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SecondNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(ThirdNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FourthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(FifthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SixthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(SeventhNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(EighthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(NinthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA104")
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  See(TenthNearest([GOODCUTOFF.HUMANOID]))
  !Class(LastSeenBy(Myself),MONK)
  !Kit(LastSeenBy(Myself),INQUISITOR)
  !Kit(LastSeenBy(Myself),CAVALIER)
  !Race(LastSeenBy(Myself),ELF)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_DISABLED)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
  !CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
  !CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
  !CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
  !HasItemEquiped("MISC73",LastSeenBy(Myself))
  !HasItemEquiped("HELM06",LastSeenBy(Myself))
  !HasItemEquiped("NEVILCUTOFFHAN",LastSeenBy(Myself))
  !HasItemEquiped("SHLD25",LastSeenBy(Myself))
  !HasItemEquipedReal("SW2H14",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquipedReal("SPER07",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H35",LastSeenBy(Myself))
  !HasItemEquipedReal("STAF11",LastSeenBy(Myself))
  !HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
  !HasItemEquipedReal("SW1H54",LastSeenBy(Myself))
  !HasItemEquiped("IMOENHP1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA104",LastSeenBy(Myself))
    SetInterrupt(TRUE)
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HaveSpellRES("C0SA208")
  !See([GOODCUTOFF])
  Detect([GOODCUTOFF])
  Range(LastSeenBy(Myself),12)
  !StateCheck(LastSeenBy(Myself),STATE_SILENCED)
  !StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
  CheckStatLT(Myself,50,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
  CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
  CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
  !CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
  !HasItemEquiped("NPMISC1",LastSeenBy(Myself))
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    SpellRES("C0SA208",Myself)
END

IF
  Global("OH_Heal","LOCALS",1)
  OR(2)
    HPPercentGT(Myself,84)
    !HasItem("POTN52",Myself)
THEN
  RESPONSE #100
    SetGlobal("OH_Heal","LOCALS",0)
END

IF
  HPPercentLT(Myself,85)
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN52",Myself)
THEN
  RESPONSE #100
    SetGlobal("OH_Heal","LOCALS",1)
END

IF
  Global("OH_Heal","LOCALS",1)
  !StateCheck(Myself,STATE_INVISIBLE)
  !Global("dvgldust","LOCALS",1)
  HasItem("POTN10",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  !CheckStatGT(Nearestenemyof(Myself),0,TRUE_SIGHT)
  !CheckStatGT(Player2,0,TRUE_SIGHT)
  !CheckStatGT(Player3,0,TRUE_SIGHT)
  !CheckStatGT(Player4,0,TRUE_SIGHT)
  !CheckStatGT(Player5,0,TRUE_SIGHT)
  !CheckStatGT(Player6,0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
  !CheckStatGT([GOODCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN10",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN11",Myself)
  CheckStatGT(Myself,0,ARMORCLASS)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN11",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
    SetInterrupt(TRUE)
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN35",Myself)
  CheckStatLT(Myself,50,MAGICDAMAGERESISTANCE)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN35",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN14",Myself)
  !StateCheck(Myself,STATE_HASTED)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN14",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN34",Myself)
  CheckStatLT(Myself,100,RESISTMAGIC)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN34",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN21",Myself)
  CheckStat(Myself,0,SCRIPTINGSTATE4)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN21",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN45",Myself)
  !CheckStatGT(Myself,0,CLERIC_FREE_ACTION)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN45",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HasItem("POTN05",Myself)
  CheckStatLT(Myself,22,STR)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN05",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
    SetInterrupt(TRUE)
END

IF
  Global("OH_Heal","LOCALS",1)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
  HasItem("POTN52",Myself)
  HPPercentLT(Myself,85)
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN52",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",1)
  HasItem("POTN55",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN55",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",1)
  !HasItem("POTN55",Myself)
  HasItem("POTN52",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN52",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF
  Global("OH_Heal","LOCALS",0)
  HPPercentLT(Myself,85)
  HasItem("POTN55",Myself)
  !GlobalTimerNotExpired("OH_Cast","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("OH_Cast","LOCALS",ONE_ROUND)
    UseItem("POTN55",Myself)
    DisplayStringHead(Myself,46150) // '*quaffs a potion*'
END

IF Allegiance(Myself,GOODCUTOFF)
  Global("OH_Heal","LOCALS",0)
  Global("OH_Active","LOCALS",1)
  !Detect([GOODCUTOFF])
  InMyArea(Nearestenemyof(Myself))
  !StateCheck(Myself,STATE_BLIND)
  !StateCheck(Nearestenemyof(Myself),STATE_REALLY_DEAD)
  OR(2)
    RandomNum(5,1)
    CombatCounter(0)
THEN
  RESPONSE #100
    MoveToObject(Nearestenemyof(Myself))
END

IF Allegiance(Myself,GOODCUTOFF)
  !Global("OH_Heal","LOCALS",1)
  Global("OH_Active","LOCALS",1)
  !See([GOODCUTOFF])
  RandomNum(2,1)
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF Allegiance(Myself,GOODCUTOFF)
  !GlobalTimerNotExpired("OH_TStop","LOCALS")
  Global("OH_Heal","LOCALS",1)
  GlobalTimerNotExpired("OH_Cast","LOCALS")
  See([GOODCUTOFF])
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF Allegiance(Myself,GOODCUTOFF)
  Range(Nearestenemyof(Myself),5)
  See(Nearestenemyof(Myself))
  HPPercentLT(Myself,85)
  HaveSpellRES("spsd02")
  OR(2)
  HasItem("POTN10",Myself)
  HasItem("POTN52",Myself)
THEN
  RESPONSE #100
	SpellRES("spsd02",Myself)
	SmallWait(5)
	RunAwayFrom(Nearestenemyof(Myself),10)
	Continue()
END

IF
  OR(2)
    StateCheck(Myself,STATE_IMMOBILE)
    StateCheck(Myself,STATE_REALLY_DEAD)
THEN
  RESPONSE #100
    NoAction()
END

IF
  !Allegiance(Myself,EVILCUTOFF)
  !InActiveArea(Myself)
  !Range(NearestEnemyOf(Myself),30)
THEN
  RESPONSE #100
    NoAction()
END

IF
  StateCheck(Myself,STATE_PANIC)
THEN
  RESPONSE #100
    RandomWalkContinuous()
END

IF
  Global("BD_RangedA","LOCALS",0)
  IsWeaponRanged(Myself)
THEN
  RESPONSE #100
    SetGlobal("BD_RangedA","LOCALS",1)
    Continue()
END

IF
  Global("BD_RangedA","LOCALS",0)
  !IsWeaponRanged(Myself)
THEN
  RESPONSE #100
    SetGlobal("BD_RangedA","LOCALS",2)
    Continue()
END

IF
  Global("BD_RangedA","LOCALS",1)
  Range(NearestEnemyOf(Myself),4)
  IsWeaponRanged(Myself)
THEN
  RESPONSE #100
    EquipMostDamagingMelee()
    Continue()
END

IF
  Global("BD_RangedA","LOCALS",1)
  !Range(NearestEnemyOf(Myself),4)
  !IsWeaponRanged(Myself)
  CanEquipRanged()
THEN
  RESPONSE #100
    EquipRanged()
    Continue()
END

IF
  See(NearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
  See(NearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
  !StateCheck(SixthNearestEnemyOf(Myself),STATE_PANIC)
  CheckStatLT(SixthNearestEnemyOf(Myself),1,STONESKINS)
  !StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
  See(SixthNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
  !StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
  CheckStatLT(FifthNearestEnemyOf(Myself),1,STONESKINS)
  !StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
  See(FifthNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
  !StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
  CheckStatLT(FourthNearestEnemyOf(Myself),1,STONESKINS)
  !StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
  See(FourthNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
  !StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
  CheckStatLT(ThirdNearestEnemyOf(Myself),1,STONESKINS)
  !StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
  See(ThirdNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
  !StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
  CheckStatLT(SecondNearestEnemyOf(Myself),1,STONESKINS)
  !StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
  See(SecondNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
  !StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
  CheckStatLT(NearestEnemyOf(Myself),1,STONESKINS)
  !StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
  See(NearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  AttackedBy(NearestEnemyOf(Myself),DEFAULT)
  WeaponEffectiveVs(LastAttackerOf(Myself),MAINHAND)
  WeaponCanDamage(LastAttackerOf(Myself),MAINHAND)
  !StateCheck(LastAttackerOf(Myself),STATE_PANIC)
  !StateCheck(LastAttackerOf(Myself),STATE_MIRRORIMAGE)
  CheckStatLT(LastAttackerOf(Myself),1,STONESKINS)
  Range(LastAttackerOf(Myself),8)
  RandomNum(3,1)
  See(LastAttackerOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  AttackedBy(NearestEnemyOf(Myself),DEFAULT)
  WeaponEffectiveVs(LastAttackerOf(Myself),MAINHAND)
  WeaponCanDamage(LastAttackerOf(Myself),MAINHAND)
  !StateCheck(LastAttackerOf(Myself),STATE_PANIC)
  !StateCheck(LastAttackerOf(Myself),STATE_MIRRORIMAGE)
  CheckStatLT(LastAttackerOf(Myself),1,STONESKINS)
  Range(LastAttackerOf(Myself),4)
  See(LastAttackerOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
  StateCheck(SixthNearestEnemyOf(Myself),STATE_IMMOBILE)
  See(SixthNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
  StateCheck(FifthNearestEnemyOf(Myself),STATE_IMMOBILE)
  See(FifthNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
  StateCheck(FourthNearestEnemyOf(Myself),STATE_IMMOBILE)
  See(FourthNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
  StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMMOBILE)
  See(ThirdNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
  StateCheck(SecondNearestEnemyOf(Myself),STATE_IMMOBILE)
  See(SecondNearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
  WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
  StateCheck(NearestEnemyOf(Myself),STATE_IMMOBILE)
  See(NearestEnemyOf(Myself))
  False()
THEN
  RESPONSE #100
    NoAction()
END

IF
  Allegiance(Myself,GOODCUTOFF)
  OR(2)
    ActionListEmpty()
    Specifics(Myself,SPIRIT)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  Allegiance(LastSeenBy(Myself),EVILCUTOFF)
  !InParty(LastSeenBy(Myself))
THEN
  RESPONSE #100
    AttackOneRound(LastSeenBy(Myself))
END

IF
  Allegiance(Myself,EVILCUTOFF)
  !StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
  !Allegiance(LastSeenBy(Myself),EVILCUTOFF)
THEN
  RESPONSE #100
    AttackOneRound(LastSeenBy(Myself))
END

