BEGIN C0SAORB

IF ~OR(2)
Class(Lastsummonerof(Myself),MAGE_ALL)
Class(Lastsummonerof(Myself),BARD_ALL)~ a
SAY ~Strands of magical power strike against the inner surface of the orb. You suddenly feel an overwhelming surge of negative emotions - anger, despair, fear, loss - and you realize that the magic desires a living host. It offers power - but at a price. You will wield the magical energy of the Shadow Weave, but your connection to the Weave will be severed forever.~ [C0BLANK]
+ ~CheckStatGT(Lastsummonerof(Myself),11,CON)
CheckStatGT(Lastsummonerof(Myself),8,INT)
CheckStatGT(Lastsummonerof(Myself),8,CHR)~ + ~Shatter the orb, allowing the magic to enter your body.~ DO ~TakePartyItem("c0saorb") DestroyItem("c0saorb")~ + a2
+ ~OR(3)
!CheckStatGT(Lastsummonerof(Myself),11,CON)
!CheckStatGT(Lastsummonerof(Myself),8,INT)
!CheckStatGT(Lastsummonerof(Myself),8,CHR)~ + ~Shatter the orb, allowing the magic to enter your body.~ DO ~TakePartyItem("c0saorb") DestroyItem("c0saorb")~ + a1
++ ~Shatter the orb, but resist the malevolent presence.~ DO ~TakePartyItem("c0saorb") DestroyItem("c0saorb")~ + a0
++ ~Put the orb back into your pack.~ DO ~DestroySelf()~ EXIT
END

IF ~~ a0
SAY ~You feel a surge of rage as the magic begins to dissipate. Suddenly, the energies converse and explode in a wave of energy.~
IF ~~ DO ~ApplyDamagePercent(Player1,50,MAGIC)
ApplyDamagePercent(Player2,50,MAGIC)
ApplyDamagePercent(Player3,50,MAGIC)
ApplyDamagePercent(Player4,50,MAGIC)
ApplyDamagePercent(Player5,50,MAGIC)
ApplyDamagePercent(Player6,50,MAGIC) DestroySelf()~ EXIT
END

IF ~~ a1
SAY ~You attempt to absorb the energies, but you feel a wave of nausea, your body convulsing as you find yourself unable to maintain your focus, perhaps due to an insufficiency in your mental or physical stamina... the magic dissipates and you are left with nothing but a pile of broken shards.~
IF ~~ DO ~ApplyDamagePercent(Player1,99,MAGIC) DestroySelf()~ EXIT
END

IF ~~ a2
SAY ~Your feel triumph as the energies take possession of you, cutting you off from the magic of the Weave. You have become a Shadow Adept and may cast spells of the Shadow Weave.~
IF ~Class(Lastsummonerof(Myself),MAGE_ALL)
	!Class(Lastsummonerof(Myself),SORCERER)
	!Class(Lastsummonerof(Myself),MAGE_THIEF)
	!Class(Lastsummonerof(Myself),FIGHTER_MAGE)
	!Class(Lastsummonerof(Myself),CLERIC_MAGE)
	!Class(Lastsummonerof(Myself),FIGHTER_MAGE_CLERIC)
	!Class(Lastsummonerof(Myself),FIGHTER_MAGE_THIEF)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SADEPT))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),MAGE_ALL)
	!Class(Lastsummonerof(Myself),SORCERER)
	OR(4)
	OriginalClass(Lastsummonerof(Myself),FIGHTER)
	OriginalClass(Lastsummonerof(Myself),CLERIC)
	OriginalClass(Lastsummonerof(Myself),MAGE)
	OriginalClass(Lastsummonerof(Myself),THIEF)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SADEPT))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0sadual",Lastsummonerof(Myself))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),SORCERER)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SASORC))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),BARD_ALL)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SABARD))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),FIGHTER_MAGE)
	!OriginalClass(Lastsummonerof(Myself),FIGHTER)
	!OriginalClass(Lastsummonerof(Myself),MAGE)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SAFM))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),MAGE_THIEF)
	!OriginalClass(Lastsummonerof(Myself),MAGE)
	!OriginalClass(Lastsummonerof(Myself),THIEF)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SAMT))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),CLERIC_MAGE)
	!OriginalClass(Lastsummonerof(Myself),CLERIC)
	!OriginalClass(Lastsummonerof(Myself),MAGE)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SACM))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),FIGHTER_MAGE_THIEF)
	!OriginalClass(Lastsummonerof(Myself),FIGHTER)
	!OriginalClass(Lastsummonerof(Myself),MAGE)
	!OriginalClass(Lastsummonerof(Myself),THIEF)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SAFMT))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
IF ~Class(Lastsummonerof(Myself),FIGHTER_MAGE_CLERIC)
	!OriginalClass(Lastsummonerof(Myself),FIGHTER)
	!OriginalClass(Lastsummonerof(Myself),CLERIC)
	!OriginalClass(Lastsummonerof(Myself),MAGE)~ DO ~CreateVisualEffectObject("c0darkbo",LastTalkedToBy(Myself))
	ActionOverride(LastTalkedToBy(Myself),AddKit(C0SAFMC))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV1","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV2","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV3","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV4","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV5","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV6","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV7","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV8","LOCALS",0))
	ActionOverride(Lastsummonerof(Myself),SetGlobal("C0SALV9","LOCALS",0))
	ApplySpellRES("c0erase2",Lastsummonerof(Myself))
	DestroySelf()~ EXIT
END